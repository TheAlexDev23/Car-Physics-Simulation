using UnityEngine;

public class MainCarSimulationScript : MonoBehaviour {
    private Rigidbody cmp_rb;
    public void Start() {
        cmp_rb = GetComponent<Rigidbody>();
        cnst_Cdrag = 0.4257f; //TODO: Add explanation to this value
        cnst_Crr   = 12.8f; //TODO: Add explanation to this value
    }


    private Vector3 Ftraction; //Traction generated by wheels rolling on the surface
    private Vector3 Fdrag; //Air resistance
    private Vector3 Frr; //Rolling resistance
    private Vector3 Flong; //The total longtitudinal force
    public float var_EngineForce;
    private float _var_EngineForce;
    private float cnst_Cdrag; //Air resistance constant
    private float cnst_Crr; //Rolling resisteance constant
    
    public void FixedUpdate() {
        var x = Input.GetAxis("Horizontal");
        var z = 1 - x * x;

        var u = new Vector3(x, 0, z);
        u = u.normalized;
        
        var velocity = cmp_rb.velocity;

        //Calculation of forces 
        _var_EngineForce = var_EngineForce * Input.GetAxis("Vertical");
        Ftraction = _var_EngineForce * u;
        Fdrag     = -cnst_Cdrag * velocity * velocity.magnitude; 
        Frr       = -cnst_Crr * velocity;

        Flong = Ftraction + Fdrag + Frr;

        cmp_rb.AddForce(Flong);
    }
}
